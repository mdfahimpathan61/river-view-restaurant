<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>River View Restaurant</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" />
  <link rel="icon" type="image/x-icon" href="/image/restaurant (1).png">
  <style>
  a:hover {
    background-color: transparent !important;
  }
</style>
</head>
<body class="bg-gray-50">

  <!-- Navbar -->
  <div class="navbar bg-base-100 shadow">
    <div class="flex-1">
      <img src="image/restaurant (3).png" class="h-10 w-10 mr-2" alt="Logo">
      <a class="text-xl font-bold">River View Restaurant</a>
    </div>
    <div class="flex-none">
      <ul class="menu menu-horizontal px-2 gap-5" id="nav-links"></ul>
    </div>
  </div>

  <!-- Hero -->
  <section id="home" class="hero min-h-[70vh]" style="background-image: url('image/slider_1.jpeg');">
    <div class="hero-overlay bg-opacity-50"></div>
    <div class="hero-content text-center text-neutral-content">
      <div class="max-w-md">
        <h1 class="mb-5 text-5xl font-bold">Welcome to River View</h1>
        <p class="mb-5">Taste the flavor, feel the river breeze ðŸŒŠ</p>
      </div>
    </div>
  </section>

  <!-- Food Menu -->
  <section class="mt-12 p-6">
    <h2 class=" text-gray-500 text-3xl font-bold text-center mb-6 ">Our Items</h2>
    <div id="food-list" class="grid md:grid-cols-3 gap-6"></div>
  </section>

  <!-- Reviews Section -->
  <section id="reviews" class="p-6 my-10">
    <h2 class="text-gray-500 text-2xl font-bold mb-3">Customer Reviews</h2>
    <div id="review-list" class="space-y-2 mb-4"></div>

    <div class="card p-4 bg-white shadow-xl my-8">
      <h3 class="text-gray-500 text-2xl font-semibold mb-2">Write your Review -</h3>
      <textarea id="review-message" placeholder="Your review..." class="textarea textarea-bordered w-[75%] mb-4 p-16 mx-auto"></textarea>
      <button onclick="submitReview()" class="btn border border-green-400 bg-green-300 text-white hover:bg-green-400 hover:text-white hover:border-white w-[30%] text-lg mx-auto ">Submit Review</button>
    </div>
  </section>

  <!-- Cart Modal -->
  <div id="cart-modal" class="  fixed inset-0 bg-black bg-opacity-40 hidden justify-center items-center">
    <div class="border-2 border-black-300  mx-auto my-20 bg-white w-96 py-10 px-6 rounded-lg ">
      <h2 class="text-black text-xl font-bold mb-2">Your Cart</h2>
      <ul id="cart-items" class="list-disc pl-5 mb-2"></ul>
      <p class="text-gray-700">Total: <span class="text-black" id="cart-total">00</span> à§³</p>
      <button onclick="placeOrder()" class="btn btn-outline btn-success mt-2 w-full">Place Order</button>
      <button onclick="toggleCart()" class="btn btn-outline btn-error mt-2 w-full">Close</button>
    </div>
  </div>



<!-- Footer 2 -->
<hr>
<footer class="footer bg-gray-200 footer-horizontal footer-center  text-primary-content p-10">
  <aside>
    <img src="image/restaurant (3).png" alt="">
    <p class="font-bold">
      River View Restaurant
      <br />
      Serving healthy and testy food since 2025
    </p>
    <p>Copyright Â© <span id="year"></span> - All right reserved</p>
  </aside>
  <nav>
    <div class="grid grid-flow-col gap-4">
      <a href="https://x.com/1452Md86857" target="_blank">
        <img src="image/twitter (1).png" alt="">
      </a>
      <a href="https://www.youtube.com/" target="_blank">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          class="fill-current">
          <path
            d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path>
        </svg>
      </a>
      <a href="https://www.facebook.com/mdfahimpathan61" target="_blank">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          class="fill-current">
          <path
            d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
        </svg>
      </a>
    </div>
  </nav>
</footer>


  

  <script>
    const API_URL = "http://localhost:5000";
    let token = localStorage.getItem("token");
    let cart = [];

    // Navbar
    function updateNavbar() {
      const nav = document.getElementById("nav-links");
      if(token) {
        nav.innerHTML = `
          <li ><a href="index.html#home" class="text-yellow-300 hover:border-b hover:border-yellow-300 transition duration-200">Home</a></li>
          <li><a href="index.html#about"  class="text-yellow-300 hover:border-b hover:border-yellow-300 transition duration-200">About</a></li>
          <li><a href="account.html"  class="text-yellow-300 hover:border-b hover:border-green-400 transition duration-200">ðŸ‘¤ Account</a></li>
          <li><a  class="text-yellow-300 hover:border-b hover:border-yellow-300 transition duration-300" onclick="toggleCart()">Cart ðŸ›’ (<span id="cart-count">${cart.length}</span>)</a></li>
        `;
      } else {
        nav.innerHTML = `
          <li ><a href="index.html#home" class="text-yellow-300 hover:border-b hover:border-yellow-300 transition duration-200">Home</a></li>
          <li><a href="index.html#about"  class=" text-yellow-300 hover:border-b hover:border-yellow-300 transition duration-200">About</a></li>
          <li><a href="login.html"   class="text-yellow-300 hover:border-b hover:border-red-400 transition duration-200">Login / Signup</a></li>
          <li><a class="text-yellow-300 hover:border-b hover:border-yellow-300 transition duration-200" onclick="toggleCart()">Cart ðŸ›’ (<span id="cart-count">${cart.length}</span>)</a></li>
        `;
      }
    }

    // Load Foods
    async function loadFoods() {
      try {
        const res = await fetch(`${API_URL}/foods`);
        if(!res.ok) throw new Error("Failed to load foods");
        const foods = await res.json();
        const list = document.getElementById("food-list");
        list.innerHTML = "";
        foods.forEach(f => {
          list.innerHTML += `
            <div class="card bg-white shadow-yellow-100 shadow-sm">
              <figure><img src="${f.image}" alt="${f.name}" class="h-80 w-full object-cover"></figure>
              <div class="card-body">
                <h2 class="card-title text-gray-500">${f.name}</h2>
                <p class="text-gray-400">${parseFloat(f.price).toFixed(2)} à§³</p>
                <div class="card-actions">
                  <button onclick="addToCart(${f.food_id}, '${f.name}', ${parseFloat(f.price)})" class="border-none btn bg-yellow-200 hover:bg-yellow-300 text-gray-600 hover:text-white">Add to Cart</button>
                </div>
              </div>
            </div>
          `;
        });
      } catch(err) {
        console.error(err);
        alert("Error loading foods");
      }
    }

    // Cart functions
    function addToCart(id, name, price){
      if(!token) return alert("Please login first!");
      price = parseFloat(price);
      const item = cart.find(i => i.food_id === id);
      if(item) item.quantity++;
      else cart.push({ food_id: id, name, price, quantity: 1 });
      updateCartUI();
    }

    function updateCartUI(){
      const ul = document.getElementById("cart-items");
      ul.innerHTML = "";
      let total = 0;
      cart.forEach(i => {
        ul.innerHTML += `<li>${i.name} - ${i.price.toFixed(2)} à§³ x ${i.quantity}</li>`;
        total += i.price * i.quantity;
      });
      document.getElementById("cart-total").innerText = total.toFixed(2);
      const countSpan = document.getElementById("cart-count");
      if(countSpan) countSpan.innerText = cart.length;
    }

    function toggleCart(){
      document.getElementById("cart-modal").classList.toggle("hidden");
    }

    async function placeOrder(){
      if(cart.length === 0) return alert("Cart is empty!");
      try {
        const res = await fetch(`${API_URL}/cart/order`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": token
          },
          body: JSON.stringify({ cart })  // send cart array
        });
        const data = await res.json();
        if(res.ok){
          alert(data.message);
          cart = [];
          updateCartUI();
          toggleCart();
        } else {
          alert(data.message || "Error placing order");
        }
      } catch(err){
        console.error(err);
        alert("Error placing order");
      }
    }

    // Reviews
    async function loadReviews(){
      try {
        const res = await fetch(`${API_URL}/reviews`);
        if(!res.ok) throw new Error("Failed to load reviews");
        const reviews = await res.json();
        const div = document.getElementById("review-list");
        div.innerHTML = "";
        reviews.forEach(r => {
          div.innerHTML += `<div class="p-2 border rounded bg-white"><strong>${r.name}</strong>: ${r.message}</div>`;
        });
      } catch(err){
        console.error(err);
      }
    }

    async function submitReview(){
      const message = document.getElementById("review-message").value.trim();
      if(!message) return alert("Please enter review");
      try{
        const res = await fetch(`${API_URL}/reviews`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": token
          },
          body: JSON.stringify({ message })
        });
        const data = await res.json();
        if(res.ok){
          alert("Review submitted!");
          document.getElementById("review-message").value = "";
          loadReviews();
        } else {
          alert(data.message || "Error submitting review");
        }
      } catch(err){
        console.error(err);
        alert("Error submitting review");
      }
    }

    // Footer year
    document.getElementById("year").innerText = new Date().getFullYear();

    // Initial load
    document.addEventListener("DOMContentLoaded", () => {
      updateNavbar();
      loadFoods();
      loadReviews();
    });

  </script>

  <script src="https://kit.fontawesome.com/a2e0d6c6f2.js" crossorigin="anonymous"></script>
</body>
</html>
